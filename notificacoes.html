<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notifica√ß√µes ‚Äî CSA</title>
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/icons.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/pages.css">
  <link rel="stylesheet" href="css/animations.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå±</text></svg>">
</head>
<body>
  <div id="app-header"></div>

  <section class="page-hero">
    <div class="container">
      <div class="breadcrumb">
        <a href="index.html">In√≠cio</a>
        <span class="sep">/</span>
        <span>Notifica√ß√µes</span>
      </div>
      <h1>Suas <span>Notifica√ß√µes</span></h1>
      <p>Fique por dentro de tudo que acontece na comunidade CSA.</p>
    </div>
  </section>

  <main class="page-section">
    <div class="container" style="max-width:800px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--space-6);">
        <div class="filter-pills">
          <button class="filter-pill active" onclick="filterNotifs('all',this)">Todas</button>
          <button class="filter-pill" onclick="filterNotifs('unread',this)">N√£o lidas</button>
          <button class="filter-pill" onclick="filterNotifs('read',this)">Lidas</button>
        </div>
        <button class="btn btn-ghost btn-sm" onclick="markPageAllRead()" data-tooltip="Marcar todas como lidas">
          ${Icons.check(14)} Marcar todas como lidas
        </button>
      </div>

      <div class="notif-page-list" id="notif-list"></div>

      <div class="empty-state" id="empty-state" style="display:none;">
        <div>${Icons.bell(48)}</div>
        <h3>Nenhuma notifica√ß√£o</h3>
        <p>Voc√™ est√° em dia! Novas notifica√ß√µes aparecer√£o aqui.</p>
      </div>
    </div>
  </main>

  <div id="app-footer"></div>

  <script src="js/icons.js"></script>
  <script src="js/data.js"></script>
  <script src="js/app.js"></script>
  <script>
    document.getElementById('app-header').innerHTML = renderHeader('');
    document.getElementById('app-footer').innerHTML = renderFooter();
    initNotifications();

    // Extended notifications
    const allNotifications = [
      ...window.CSA.notifications,
      { id: 6, icon: 'green', iconName: 'leaf', text: 'Nova temporada de <strong>frutas c√≠tricas</strong> come√ßou!', time: 'H√° 3 dias', unread: false },
      { id: 7, icon: 'blue', iconName: 'course', text: 'Voc√™ completou 75% do curso <strong>Horta Org√¢nica</strong>.', time: 'H√° 4 dias', unread: false },
      { id: 8, icon: 'orange', iconName: 'star', text: 'Avalie seu √∫ltimo pedido e ganhe <strong>pontos</strong>!', time: 'H√° 5 dias', unread: false },
      { id: 9, icon: 'green', iconName: 'members', text: 'O produtor <strong>S√≠tio Boa Vista</strong> adicionou novos produtos.', time: 'H√° 1 semana', unread: false },
      { id: 10, icon: 'red', iconName: 'heart', text: 'Seu favorito <strong>Queijo Minas</strong> est√° em promo√ß√£o!', time: 'H√° 1 semana', unread: false },
    ];

    let currentFilter = 'all';

    function renderNotifications(filter) {
      let notifs = allNotifications;
      if (filter === 'unread') notifs = notifs.filter(n => n.unread);
      if (filter === 'read') notifs = notifs.filter(n => !n.unread);

      const list = document.getElementById('notif-list');
      const empty = document.getElementById('empty-state');

      if (notifs.length === 0) {
        list.innerHTML = '';
        empty.style.display = 'block';
      } else {
        empty.style.display = 'none';
        list.innerHTML = notifs.map((n, i) => `
          <div class="notif-page-item ${n.unread ? 'unread' : ''} fade-in-up stagger-${(i % 8) + 1}" onclick="toggleRead(${n.id})">
            <div class="notif-page-icon ${n.icon}">${Icons[n.iconName](20)}</div>
            <div class="notif-page-content">
              <p>${n.text}</p>
              <span>${n.time}</span>
            </div>
            ${n.unread ? `<span class="badge badge-green" style="font-size:10px;">Nova</span>` : ''}
          </div>
        `).join('');
        setTimeout(initScrollAnimations, 50);
      }
    }

    function filterNotifs(filter, btn) {
      currentFilter = filter;
      document.querySelectorAll('.filter-pill').forEach(p => p.classList.remove('active'));
      btn.classList.add('active');
      renderNotifications(filter);
    }

    function toggleRead(id) {
      const n = allNotifications.find(x => x.id === id);
      if (n) n.unread = false;
      renderNotifications(currentFilter);
    }

    function markPageAllRead() {
      allNotifications.forEach(n => n.unread = false);
      window.CSA.notifications.forEach(n => n.unread = false);
      renderNotifications(currentFilter);
      showToast('Todas as notifica√ß√µes marcadas como lidas', 'check');
    }

    renderNotifications('all');
  </script>
</body>
</html>
